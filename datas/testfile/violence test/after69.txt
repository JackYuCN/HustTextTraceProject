１引言
随着举世信息化的不断推动以及互联网的高速起色，数据动作主要的生产因素已经渗透到各个领域。人们对海量数
据的挖掘和利用，记号着大数据时代的到来。大数据平台中的文献不妨蕴涵用户隐私、敏感数据、商业秘密等新闻，要是文件被敌意用户窃取后传播到公布网络或平台，则会暴露用户隐私，泄露贸易机密，引起版权纠葛，从而造成严重后果，因而经历对平台中的文件进行秘密保护并担保文件宣泄后的可
追忆性成为研究的焦点。
２０１０年，ＡｐａｃｈｅＨａｄｏｏｐ组织将大数据定义为：“平时的计算机软件无法在可接受的时间界线内捕捉、管理、处罚范畴
庞大的数据集。”大数据的多见特点包含：强大的数据体量（Ｖｏｌｕｍｅ）、繁多的数据类型（Ｖａｒｉｅｔｙ）、快速的数据处理（Ｖｅ－ｌｏｃｉｔｙ）和超低的代价密度（Ｖａｌｕｅ）。其中，众多的数据类型是
指，相比易于存储的结构化数据，大数据平台中的非结构化数据和半结构化数据（如文本、图像、多媒体等新闻）的占比越来越大。
随着大数据技术的继续发展，好多传统的信息安全技术受到了挑战。在洪量的数据产生、汇集、存储和理解的流程中，既会涉及一些古板的安全问题，也会涉及一些新的安全问题，并且这两类题目会因数据范畴、处理过程、安全要求等因素而被继续扩大。大量事实证据，若大数据未被妥善处理，则会对用户的秘密造成极大的加害。依据古板安全策略，数据颠末匿名化处罚后就可能被公布发布了。但在实际的互联网应用中，用户数据的收集、存储、打点和使用等均缺乏典范标准，未能得到灵验监督，仅靠企业的自律是不够的，用户对自
己隐私新闻的用途无从得知［１］。
为了解决数据的隐私保护和溯源跟踪问题，数字水印（ＤｉｇｉｔａｌＷａｔｅｒｍａｒｋｉｎｇ）作为一种主要的技术手段，一直以来
被学术界和工业界广博接洽和使用。数据水印技艺是将一些标识新闻（即数字水印）直接嵌入数字载体（包括多媒体、文档、软件等）中或是含蓄展现（修改特定地区的结构），且不劝化原载体的使用价值，也不容易被探知和再次修改。数字水印是维护信息安全、兑现防伪溯源和版权保护的灵验对策，是信息障翳技术接洽界线的重要分支。
当前，数字水印的接洽大多集中在图像数据、音频数据、视频数据，对文本水印的接洽相对较少。而大数据平台中的很大一部分数据是由文本形式存储的，如日记文件、买卖记实、推荐记录等，因此，大数据境遇下的文本水印方案引起了越来越广泛的关注，成为了信息安全的热点研究界线。
在大数据平台和大数据推算中，洪量的数据为纯文本数据，而在纯文本中嵌入水印较为困难，这关键是因为纯文本有其特殊性。
（１）广义的文本是由内容和花样组成的，因为对文档内容的体现格局不同，因此文本文档的花样也不尽相同，纯文本有ＴＸＴ和ＣＳＶ等多种格式。
（２）各样花样的文件通常可以互相转换，甚至可以径直抽取文件中的纯文本实质，如此原先嵌入在花样中的水印新闻便荡然无存了。（３）ＷＯＲＤ和ＰＤＦ等富文本由内容和机关构成，可能将水印嵌入结构中；而纯文本莫得文档机关，仅由字符构成，每个字符都有固定的编码，没有可以嵌入水印信息的多余空间。
（４）图像、音频、视频对象中存在洪量的冗余位，在不引起知觉变化的条件下可以将冗余位简略或者进行任意的修改替
换，水印可以隐藏其中。而对付文本，必要团结文本实质举办删除或窜改才不会改变文章开心。
针对大数据纯文本的上述特征，本文提出了一种基于正交编码的大数据纯文本水印方法。该对策经历在行尾嵌入不可见字符及改变行序的方法，将水印嵌入纯文本中，其具备不仰仗原始记录的排列顺序，所需的水印空间较小，合用于水印空间较小的纯文本数据等优点，同时正交编码方法统筹了水印的隐蔽性和健壮性。基于Ｓｐａｒｋ平台兑现的本文编制，满
足大数据性能需求和分布式处罚条件。
２相干接洽
当前大数据安全面临的挑战性题目主要有大数据秘密维护和数据泄露防护等。针对上述安然挑战，孕育了大数据安
全关键技术，数字水印技术是其中一个重要的接洽方向。
近年来，数字水印技艺接洽取得了很大的起色，模范的数字水印技术主要包括空域算法、频域算法、收缩域算法等。这些算法主要针对图像数据、音频数据、视频数据，针对文本的数字水印算法相对较少。目前常用的文本水印技术关键包含以下几类。
（１）基于文档机关的文本水印方法。这类算法主要合用于具备设立文本排版花样性能的文档，如ＷＯＲＤ，ＰＰＴ和ＰＤＦ等。Ｂｒａｓｓｉ等［２－３］建议了３种出名的文本水印编码技术，经历文档自身的特征进行文档结构微调编码，包括文本的行间距编码、字间距编码和特点编码，从而兑现水印新闻的嵌入。文件［４］提出经历改变ＷＯＲＤ中字体颜色的ＲＧＢ分量低位数值来嵌入水印。除此之外，还可以转移文本字体或字符流形来嵌入水印新闻［５］。通过这类对策嵌入的水印很难用肉眼发现，而且嵌入空间较大，但是针对文本的一面拷贝或修改不妨致使水印新闻不完整，无花样拷贝或格式修改将会导致水印无缺被去除［６］。
（２）基于自然语言的文本水印对策。语言存在多种表述格局，通过自然语言处罚技术，可以在不转移原文兴味的情况下，对部分文本推行等价新闻替换和语序修改等操纵，从而兑现水印信息的障翳［７］。今朝，自然语言文本数字水印对策主要有基于句法结构和基于语义两类［８－９］。文献［１０］和文件［１１］分别是基于句法结构和基于语义的模范水印对策。此类对策具有极高的隐藏性，不依赖文本格式和编码，虽然最新的技术曾经可能恢复原文［１１］，但兑现流程极为繁杂。其余，文本的讲话多种多样，包含英文、汉语、阿拉伯语等，今朝的许多文本水印算法都是针对英文或汉语的特有语法设想而生，不具备语言的普适性，而适用于任何讲话文本的数字水印对策的接洽还尚未打开［１２］。
（３）不可见编码算法。不可见编码可细分为不可见字符编码、附加空格编码等方案，合用于非格式化文本，即纯文本。不可见字符编码经历在文本中插入不可打印的ＡＳＣＩＩ字符
或许不可见Ｕｎｉｃｏｄｅ控制字符等来存储水印新闻。文件［１３－１４］提出了在网页文本中嵌入零宽度控制字符来嵌入水印新闻。张震宇等［１５］在其基础上建议在文本句号前嵌入不可见Ｕｎｉｃｏｄｅ控制字符的方法，该方法合用于任性Ｕｎｉｃｏｄｅ编码格式的文本。附加空格编码算法日常将信息编码隐藏在字处罚编制的断行处，行尾或字间是否有空格和制表符在视觉上难以发觉［１６－１７］，在提取时可通过不可见编码的有无、品种及数量举办解码。文献［１８］通过改变空格的商标及上下标属性来展现二进制序列，从而将水印嵌入ＷＯＲＤ文档中。
现有的数字水印方案能够为大数据提供可信性保护，但大数据平台的分布式数据处理机制，使得在对大数据文本文件举办处理后无法保证数据递次与原有递次一致。今朝已有的水印嵌入与提炼对策严酷依赖原始数据的记实递次，不适用于大数据平台数据的水印处罚，同期削弱了水印的隐蔽性。与数据递次无关的水印方法必要在水印记实中添加教唆新闻，扩充了水印容量开销，不适用于冗余空间有限的纯文本数据。因而，满足数据量巨大的水印方案还需进一步接洽与探讨。
本文提出的文本水印对策，针对大数据境遇下的大批量纯文本文件进行水印嵌入，嵌入对策不依赖于原始记录的行序，合用于大数据水印处罚，且不在水印记录中添加指示信息，一定程度地减小了水印容量。
３基于正交编码的大数据纯文本水印方法
纯文本是大数据平台存储和推算中使用得最广博的数据类型，多见的有以ｔｘｔ和ｃｓｖ为后缀的文献以及无后缀的ｌｏｇ
文件等，纯文本之间可以相互蜕变。其中，逗号分隔值（Ｃｏｍ－ｍａ－ＳｅｐａｒａｔｅｄＶａｌｕｅｓ，ＣＳＶ）文献以纯文本形式存储表格数据（数字和文本）。ＣＳＶ文献示意图如图１所示，其由任性数量
的记录构成，记实间以某种换行符分隔；每条记录由字段构成，字段间的分隔符是其他字符或字符串，最常见的是逗号。平日，扫数记录都有完全相同的字段序列。ＣＳＶ文件由于本身的实质不依赖于行序，符合大数据平台的分布式数据处理机制，因此是一类多见的大数据纯文本格式。本文以ＣＳＶ文件为例来理解介绍水印算法。图１ＣＳＶ文件格式样例
Ｆｉｇ．１ＳａｍｐｌｅｆｏｒｍａｔｏｆＣＳＶｆｉｌｅ
３．１基于正交编码的水印对策模型
本文针对大数据平台纯文本文件的无序性，提出了一种基于正交编码的大数据纯文本水印对策。正交编码是指本文选拔的两种水印嵌入和提炼对策（基于行散列值和基于行序置换的水印方法）是互相正交的。其中，基于行散列值的水印嵌入方法在纯文本文件的文本行末嵌入不依赖于行序的水印
段，相当于添加了一列实质，类比为对列的改变；基于行序置换的水印嵌入对策的截止为转移行序。这两种对策是解耦合的，不会相互影响，即两种对策相互正交，称为正交编码方法。本文的水印对策模型可能使用古板水印模型表示，定义六元组（ＸＳ，ＷＳ，ＫＳ，Ｇ，Ｅ，Ｄ），其中，ＸＳ代表所要维护的纯文本文件ＸＰ的集合，ＷＳ代表所有可能水印信号Ｗ的集合，ＫＳ是水印密钥Ｋ的集合，Ｇ表示水印生成算法，Ｅ展现水印嵌入算法，Ｄ表示水印提取算法。
Ｇ∶Ｗ＝Ｇ（Ｉ，Ｋ）（１）
式（１）展现水印天生算法Ｇ。将潜伏泄密者即下载文献的人提供的个人信息、系统自动天生的年光戳新闻串联成固定长度的明文字符串Ｉ，并选拔ＡＳＣＩＩ编码或Ｕｎｉｃｏｄｅ编码对该明文字符串进行编码后生成由０和１构成的二进制水印字符串。
Ｗ＝｛ｗ（ｋ）｜ｗ（ｋ）∈Ｂ，ｋ∈Ｗｄ｝（２）
其中，Ｗｄ表示维数为ｄ的水印信号域，水印信号可能是二值形式Ｂ＝｛０，１｝，或Ｂ＝｛－１，１｝，也可能是高斯噪声形式。本文算法采用Ｂ＝｛０，１｝的样子。
Ｅ：ＸＳ×ＷＳ→ＸＳ，ＸＰｗ＝Ｅ（ＸＰ０，Ｗ）（３）
其中，ＸＰ０代表原始的数字产品，ＸＰｗ代表嵌入水印后得到的数字产品。
式（３）展现将天生的二进制水印信号Ｗ嵌入纯文本文件ＸＰ０中的嵌入算法Ｅ，水印嵌入模型如图２所示。本文采用
正交编码方法兑现水印嵌入，基于行散列值的水印嵌入对策在文本行末嵌入对应不可见水印段，基于行序置换的水印嵌入方法，根据随机数生成器天生的伪随机数选取起点行号进行行置换，从而完成水印嵌入。３．２核心算法设计
本文采用正交编码方法兑现水印嵌入。基于行散列值的水印嵌入对策，先将天生的二进制水印字符串按照每行固定嵌入的水印长度等分，再对载体文件中每行固定长度的实质举办哈希和模运算，将所得结果动作水印序列号信息，采用不可见字符代替二进制水印流，在每行末尾嵌入不可见水印字符串；基于行序置换的水印嵌入对策，遵照随机数生成器生成的伪随机数选取起点行号举办行置换，使得行的散列值代表起始记号位、二进制水印编码值和结局记号位，以此来完成水印嵌入。水印嵌入的具体步骤如下：
步骤１将潜在泄密者即下载文件的用户的个人信息以及系统主动天生的当前年光戳信息串联成固定长度的明文字
符串，对该明文字符串举办ＡＥＳ对称加密以及ＢＡＳＥ６４编码，将天生的字符串蜕变为由０和１组成的二进制水印字符串ＷＭ。
环节２将水印容量等分为Ｋ份，计算待嵌入水印份数Ｋ＝Ｌｗｍ／ｌ，其中Ｌｗｍ为二进制水印字符串长度，ｌ为每行嵌入
的固定水印长度，定义可变参数ｎ为水印的冗余度，则水印总容量Ｎ＝Ｌｗｍ＊ｎ。
步骤３逐行读取原始文件，推算每行固定位置文本实质的ＭＤ５值ｈＭＤ５，利用该行内容的ＭＤ５值对水印份数Ｋ进
行取模运算，得到结果值ｋ＝ｈＭＤ５％Ｋ。
环节４将第ｋ份二进制水印串ＷＭｋ按照式（５）所示的规则映照为不可见字符串，并将不可见字符串嵌入该行，回到
步骤３接连读取下一行，直至全数文献读取完成。１８．ｉ＜－ｒａｎｄｏｍ（０，ｒｏｗ－２ｍ－Ｎ－１）１９．ｍａｋｅｅａｃｈｖａｌｕｅｏｆＨＡＳＨ２ｏｆｌｉｎｅｉｔｏｉ＋ｍｅｑｕａｌ１２０．ｍａｋｅｅａｃｈｖａｌｕｅｏｆＨＡＳＨ２ｏｆｌｉｎｅｉ＋ｍ＋１ｔｏｉ＋ｍ＋Ｎｅｑｕａｌｗｍ２１．ｍａｋｅｅａｃｈｖａｌｕｅｏｆＨＡＳＨ２ｏｆｌｉｎｅｉ＋ｍ＋Ｎ＋１ｔｏｉ＋２ｍ＋Ｎ＋
１ｅｑｕａｌ０２２．ｗｍ＿ｆｉｌｅ．ｗｒｉｔｅｌｉｎｅｓ（ｌｉｎｅ）
２３．ｒｅｔｕｒｎｗｍ＿ｆｉｌｅ２４．ｅｎｄｆｕｎｃｔｉｏｎ２５．ｆｕｎｃｔｉｏｎｍａｉｎ（）
２６．ｗｍ＜－Ｅｎｃｏｄｅ（ｉｎｆ）
２７．ＲｏｗＳｗａｐ（ＲｏｗＨａｓｈ（ｆｉｌｅ，ｗｍ），ｗｍ）２８．ｅｎｄｆｕｎｃｔｉｏｎ
水印提取流程为嵌入的逆过程。起初，经历基于行序置换的水印提炼对策推算纯文本文件中每行的散列值，当检测到起点标志位时开始记实计算后的散列值，直到检测到结束标志位时停止，将记实下的散列值作为待对照的二进制字符串。经历基于行散列值的水印提炼对策，将载体文件中每行固定长度的实质举办哈希和模运算，将得到的结果值动作水印序列号信息，将行末的不可见字符转换为二进制字符，统计各段水印出现的次数，将次数最多的每段水印排序并合并为待对照的二进制字符串。将两串二进制序列进行对照，选拔对称密码算法对上述二进制水印字符串进行解密，将解密后的明文字符串举办反编码后得到明文水印要素信息，该新闻包括泄密者的个人信息，以及嵌入水印时的年光戳信息。水印提炼的具体步骤如下：
环节１逐行读入文本文件内容，如果检测到陆续ｍ行ＨＡＳＨ２的值为１，则从下一行初叶将ＨＡＳＨ２的值记录下来，直到检测到连续ｍ行ＨＡＳＨ２的值为０时松手检
测，将记实下的二进制字符串记为ｗａｔｅｒｍａｒｋ１。
环节２在逐行读入文本文件实质的同时，检测行末是否生活不可见字符，若存在则将该行的文本实质部分和末尾的不可见水印字符一面分割，对该行文本实质一面的固定位置计算ＭＤ５值ｈＭＤ５，推算ｋ＝ｈＭＤ５％Ｋ，其中Ｋ＝Ｌｗｍ／ｌ，Ｌｗｍ
为二进制水印字符串长度，ｌ为每行嵌入的固定水印长度。将本行的不可见水印字符一面转换为二进制串，并将其动作第ｋ份水印存储，直至全数文件读取实现。
步骤３统计第ｋ份水印中各个字符串出现的次数，将出现次数最多的字符串动作该份水印记录下来，按顺序对每份水印举办排序并组合，使其成为统统的二进制水印字符串，记为ｗａｔｅｒｍａｒｋ２。
环节４对比ｗａｔｅｒｍａｒｋ１与ｗａｔｅｒｍａｒｋ２，若两者相同且长度为Ｌｗｍ，则将ｗａｔｅｒｍａｒｋ１输出；若两者不同，则将长度为（２）对ＲＤＤ的每个键值对进行处罚，推行加水印或许提取水印操作，得到键为文件名、值为处理结果的ＲＤＤ。
（３）使用ｓａｖｅＡｓＨａｄｏｏｐＦｉｌｅ接口，存在ＲＤＤ到ＨＤＦＳ中，重写ＯｕｔｐｕｔＦｏｒｍａｔ，键为文件名，输出时只输出其值。
３．４编制架构
基于本文对策，设计并实现了一个大数据纯文本水印系统，系统架构如图４所示，水印嵌入模块和水印提炼模块基于Ｓｐａｒｋ分布式处罚平台开荒。其中，水印嵌入模块包含水印
天生单元和水印嵌入单位。水印生成单位关键举办水印新闻的预处理工作，将水印新闻串蜕变为二进制水印字符串；水印嵌入单元利用基于正交编码的水印嵌入方法将二进制水印字
符串嵌入到原始文件中。水印提炼模块包括水印提取单位和水印恢复单元。其中，水印提取单位是水印嵌入模块中的水印嵌入单元的逆流程，利用基于正交编码的水印提炼对策将嵌入文献的二进制水印字符串提取出来；水印收复单元主要将二进制水印字符串蜕变为水印新闻串，得到水印文献的明文新闻。大数据纯文本文件存储在ＨＤＦＳ分布式文件系统中，水印新闻数据库存储待嵌入水印信息及订单新闻等。本文开发了相应的系统界面，供用户进行水印嵌入、提取及文献的上传、下载等操纵。图４系统架构
Ｆｉｇ．４Ｓｙｓｔｅｍａｒｃｈｉｔｅｃｔｕｒｅ
４实验与分析
数字水印技术应该得志水印的固有特性，比方鲁棒性、隐蔽性、水印容量和算法性能等［１９－２０］，因此遵守水印的固有特
性举办水印技艺评价。本文的水印方法测试主要分为以下４个一面：１）水印对策职能检测，包含水印容量测试和针对多个文件举办大规模批量水印处理的检测；２）隐蔽性测试，针对嵌入水印前后的文件视觉效果进行对照分析；３）鲁棒性检测，针对嵌入水印后的文件进行删减、添加、拷贝、代替攻击，检测提炼水印的正确性；４）对比检测，将本文算法与３种文本水印算法进行对比理解，记实测试目标，包含处罚年光、水印提炼成功率。
４．１实验境遇
（１）硬件与集群配置
硬件设置为Ｅ５－２６０３ｖ２＠１．８０ＧＨｚＣＰＵ、８ＧＢ内存。Ｓｐａｒｋ集群由４个节点构成，即１个主节点和３个从节点。
（２）软件配置
实验环境的软件配置如表１所列。